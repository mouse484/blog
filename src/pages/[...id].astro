---
import { getCollection, render } from 'astro:content'
import Layout from '../layouts/Layout.astro'
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const posts = await getCollection('blog')
  return posts.map((post) => ({
    params: { id: post.id },
    props: { post },
  }))
}
// 2. For your template, you can get the entry directly from the prop
const { post } = Astro.props
const { Content } = await render(post)
---

<Layout>
  {post.data.canonicalUrl && <link slot="head" rel="canonical" href={post.data.canonicalUrl} />}

  <article>
    <h1>{post.data.title}</h1>
    <div>
      {
        post.data.tags?.map((tag) => {
          return <span>{tag}</span>
        })
      }
    </div>
    {
      post.data.canonicalUrl && (
        <p>
          別サイトへ投稿していた記事を移動しました、
          <a href={post.data.canonicalUrl} target="_blank" rel="noopener noreferrer">
            元記事はこちら
          </a>
        </p>
      )
    }
    <Content />
  </article>
</Layout>
